---
title: "Title"
author: "Ishani Makwana, Henry Hirsch and Ei Tanaka"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r setup, include=FALSE}
# Some of common RMD options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
# Can globally set option for number display format.
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
```

## Introduction (need edited)
**(need edited)**

```{r echo=T, eval=T, include=T, results='markup'}
# Importing a geographic health disparities data set
library(readr)

urlfile = 'https://raw.githubusercontent.com/eitanaka/DATS6101_Project1_Team2/main/dataset/geographic_health_disparities.csv'

geo_health_df <- read_csv(url(urlfile))

str(geo_health_df)
```

## Summary Statistics(need edited)

### Depression by state(need edited)
```{r echo=T, eval=T, include=T, results='markup'}
data_by_state <- split(geo_health_df, geo_health_df$StateAbbr)

summary_by_state <- lapply(data_by_state, function(x) summary(x$Data_Value.DEPRESSION))
head(summary_by_state,3)
tail(summary_by_state,3)

mean_by_state <- lapply(data_by_state, function(x) mean(x$Data_Value.DEPRESSION))
head(mean_by_state,3)
tail(mean_by_state,3)

sd_by_state <- lapply(data_by_state, function(x) sd(x$Data_Value.DEPRESSION))
head(sd_by_state,3)
tail(sd_by_state,3)

# Convert mean_by_state to a data frame
mean_df <- data.frame(State = names(mean_by_state), Mean_Depression = unlist(mean_by_state))

# Create a bar chart of the mean depression values by state
barplot(mean_df$Mean_Depression, names.arg = mean_df$State, xlab = "State", ylab = "Mean Depression Value", col = "pink", main = "Mean Depression Values by State")
```

### Mental health by state(need edited)
```{r echo=T, eval=T, include=T, results='markup'}
summary_by_state <- lapply(data_by_state, function(x) summary(x$Data_Value.MHLTH))
head(summary_by_state,3)
tail(summary_by_state,3)

mean_by_state <- lapply(data_by_state, function(x) mean(x$Data_Value.MHLTH))
head(mean_by_state,3)
tail(mean_by_state,3)

sd_by_state <- lapply(data_by_state, function(x) sd(x$Data_Value.MHLTH))
head(sd_by_state,3)
tail(sd_by_state,3)

# Convert mean_by_state to a data frame
mean_df <- data.frame(State = names(mean_by_state), Mean_MHLTH = unlist(mean_by_state))

# Create a bar chart of the mean depression values by state
barplot(mean_df$Mean_MHLTH, names.arg = mean_df$State, xlab = "State", ylab = "Mean Mental Value", col = "green", main = "Mean mental Values by State")
```

### Sleep by state(need edited)
```{r echo=T, eval=T, include=T, results='markup'}
summary_by_state <- lapply(data_by_state, function(x) summary(x$Data_Value.SLEEP))
head(summary_by_state,3)
tail(summary_by_state,3)

mean_by_state <- lapply(data_by_state, function(x) mean(x$Data_Value.SLEEP))
head(mean_by_state,3)
tail(mean_by_state,3)

sd_by_state <- lapply(data_by_state, function(x) sd(x$Data_Value.SLEEP))
head(sd_by_state,3)
tail(sd_by_state,3)

# Convert mean_by_state to a data frame
mean_df <- data.frame(State = names(mean_by_state), Mean_Sleep = unlist(mean_by_state))

# Create a bar chart of the mean depression values by state
barplot(mean_df$Mean_Sleep, names.arg = mean_df$State, xlab = "State", ylab = "Mean SLEEP Value", col = "blue", main = "Mean SLEEP Values by State")
```


